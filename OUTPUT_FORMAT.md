# RH Output Format Description

## Overview

This document describes the structure and contents of output files generated by the RH Short-Window Certificate computational framework.

## Output Directory Structure

```
RH/
├── data/                                        # Computational results
│   ├── C_right_computation_P<P>_<timestamp>.json      # From compute_C_right.py
│   ├── C_thin_measurement_<method>_R0_<R0>_<timestamp>.json  # From measure_Cthin_star.py
│   ├── C_thin_measurement_<method>_R0_<R0>_<timestamp>.csv   # Summary CSV
│   └── C_thin_hat_demo.csv                    # Legacy format for compatibility
│
└── logs/                                        # Execution logs
    ├── compute_C_right_<timestamp>.txt
    ├── measure_Cthin_star_<timestamp>.txt  
    ├── threshold_T0_<timestamp>.txt
    ├── validate_horizontals_<timestamp>.txt
    └── run_all_summary_<timestamp>.txt
```

## File Formats

### 1. C_right_computation_P<P>_<timestamp>.json

JSON file containing the right-edge constant computation results.

**Structure:**
```json
{
  "timestamp": "2025-01-23T14:30:00.123456",
  "parameters": {
    "P": 2000000,
    "method": "sieve",
    "include_prime_powers": false
  },
  "computation": {
    "partial_sum": 0.569959993,
    "tail_bound": 1.979747e-06,
    "lower_bound": 0.569959993,
    "upper_bound": 0.569961973,
    "interval_width": 1.979747e-06
  },
  "theoretical": {
    "exact_value": "sum_{n>=2} Lambda(n) / n^2",
    "numerical_approximation": 0.5699618136104756
  },
  "high_precision": {  // Optional, if method='mpmath'
    "dps": 50,
    "zeta_2": 1.6449340668482264,
    "zeta_prime_2": -0.9375482543158437,
    "C_right": 0.5699618136104756
  }
}
```

**Key fields:**
- `P`: Prime cutoff used for truncated series
- `partial_sum`: S(P) = Σ_{p≤P} log(p)/(p²-1)
- `tail_bound`: Rigorous upper bound for tail sum
- `lower_bound`, `upper_bound`: Interval containing true value
- `high_precision`: Present when using mpmath method

### 2. C_thin_measurement_<method>_R0_<R0>_<timestamp>.json

JSON file with thin-strip constant measurements and margin analysis.

**Structure:**
```json
{
  "timestamp": "2025-01-23T14:35:00.456789",
  "parameters": {
    "R0": 0.10,
    "c1": 0.666667,
    "c": 0.35,
    "kappa": 0.8,
    "T": 2.4e12,
    "method": "current",
    "sub_weyl_exp": 0.164634,
    "model": "realistic"
  },
  "derived": {
    "h": 2.531079e-05,
    "delta": 5.785037e-05,
    "alpha_star": 0.264634,
    "C_thin_star": 6.550487
  },
  "measurements": {
    "avg_proxy": 3.576324e-07,
    "std_proxy": 3.985420e-08,
    "bound_rhs": 6.383856e-07,
    "margin": 2.807532e-07,
    "margin_percent": 43.97847
  },
  "threshold": {
    "C_right": 0.569961,
    "log_T0": 3.896821,
    "T0": 49.267543
  }
}
```

**Key fields:**
- `method`: Sub-Weyl method used (current/huxley/bourgain)
- `alpha_star`: Boundary growth slope α*(R₀)
- `C_thin_star`: Main constant (8/R₀)·α*(R₀)
- `margin_percent`: Safety margin percentage
- `log_T0`, `T0`: Critical threshold values

### 3. C_thin_measurement_<method>_R0_<R0>_<timestamp>.csv

Summary CSV file for thin-strip measurements.

**Format:**
```csv
parameter,value
method,current
R0,0.10
c,0.35
kappa,0.8
T,2.4e12
sub_weyl_exp,0.164634
C_thin_star,6.550487
margin_percent,43.97847
log_T0,3.896821
```

### 4. C_thin_hat_demo.csv

Legacy format for backward compatibility.

**Format:**
```csv
t,avg_proxy,bound_rhs
2.4e12,3.576324e-07,6.383856e-07
...
```

### 5. Log Files (logs/*.txt)

Text files capturing console output during script execution.

**Structure:**
```
Script: compute_C_right.py
Arguments: --P 1000000
Started: 2025-01-23 14:30:00.123456
============================================================

COMPUTING C_right = -zeta'(2)/zeta(2)
============================================================

Main computation with P = 1000000
------------------------------------------------------------
Partial sum S(P) = 0.569959993
Tail bound       = 1.979747e-06

C_right in [0.569959993, 0.569961973]
Interval width   = 1.979747e-06

[OK] Theoretical value 0.569961813610 is within bounds

============================================================
Finished: 2025-01-23 14:30:05.789012
Return code: 0
```

### 6. run_all_summary_<timestamp>.txt

Summary file from complete verification run.

**Format:**
```
RH Verification Run Summary
Date: 2025-01-23 14:40:00.123456

compute_C_right: SUCCESS
measure_Cthin_star: SUCCESS
threshold_T0: SUCCESS
validate_horizontals: SUCCESS
```

## Usage Examples

### Loading JSON Results in Python

```python
import json
from pathlib import Path

# Find latest C_right computation
files = list(Path('data').glob('C_right_computation_*.json'))
latest = max(files, key=lambda f: f.stat().st_mtime)

with open(latest, 'r') as f:
    data = json.load(f)

print(f"C_right ∈ [{data['computation']['lower_bound']:.9f}, "
      f"{data['computation']['upper_bound']:.9f}]")
print(f"Interval width: {data['computation']['interval_width']:.2e}")
```

### Analyzing Margin Trends

```python
import pandas as pd
from pathlib import Path

# Collect all C_thin measurements
results = []
for json_file in Path('data').glob('C_thin_measurement_*.json'):
    with open(json_file, 'r') as f:
        data = json.load(f)
        results.append({
            'R0': data['parameters']['R0'],
            'c': data['parameters']['c'],
            'kappa': data['parameters']['kappa'],
            'margin': data['measurements']['margin_percent'],
            'log_T0': data['threshold']['log_T0']
        })

df = pd.DataFrame(results)
print(df.sort_values('margin', ascending=False))
```

### Reading CSV Summaries

```python
import csv

with open('data/C_thin_measurement_current_R0_0.100_20250123_143500.csv', 'r') as f:
    reader = csv.DictReader(f)
    params = {row['parameter']: row['value'] for row in reader}
    
print(f"Margin: {float(params['margin_percent']):.1f}%")
print(f"log T₀: {float(params['log_T0']):.2f}")
```

## Data Types and Precision

- **Floating point**: All numerical values use IEEE 754 double precision
- **High precision**: When using mpmath, precision is specified by `dps` field
- **Timestamps**: ISO 8601 format with microsecond precision
- **File naming**: `<timestamp>` format is `YYYYMMDD_HHMMSS`

## Notes

1. **Reproducibility**: All files include complete parameter sets for reproduction
2. **Backward compatibility**: `C_thin_hat_demo.csv` maintained for legacy scripts
3. **Log rotation**: Old logs should be periodically archived to prevent directory bloat
4. **JSON pretty-printing**: All JSON files use 2-space indentation for readability
5. **Missing data**: Scripts that only output to console (threshold_T0, validate_horizontals) save results only in log files

## Error Handling

If a computation fails:
- Partial results may be written to files
- Log files will contain error messages and stack traces
- Return codes in logs: 0 = success, non-zero = error

## File Size Considerations

Typical file sizes:
- JSON files: 2-5 KB each
- CSV files: 1-2 KB each
- Log files: 5-20 KB each
- Total storage for complete run: < 100 KB